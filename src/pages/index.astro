---
import BaseLayout from "@/layouts/BaseLayout.astro";
---

<BaseLayout
  title="MRover - University of Michigan Mars Rover Team"
  description="The Michigan Mars Rover Team (MRover) is a student-run, multidisciplinary team building rovers for Mars exploration and competing in the University Rover Challenge."
  image="https://mrover.org/images/SAR_GOBLUESHOT.png"
>
  <!-- Hero Section -->
  <div
    class="relative min-h-screen bg-cover bg-center flex items-center justify-center"
    style="background-image: url('/images/rosie_circ.jpg');"
    data-hero
  >
    <div
      class="absolute inset-0 bg-black/80"
      data-hero-overlay
    >
    </div>
    <div class="relative z-10 text-center px-6 max-w-5xl py-20">
      <!-- intro anim -->
      <div
        class="relative mb-0 flex items-center justify-center w-full"
        style="height: clamp(250px, 30vh, 400px);"
        data-intro-container
      >
        <img src="/logos/block_M.png" alt="Block M" class="absolute w-50 h-50 object-contain" data-block-m />
        <img
          src="/logos/logo_light_top.svg"
          alt="Logo Top"
          class="absolute opacity-0"
          data-logo-top
          style="transform: translateY(clamp(60px, 12vh, 120px)); width: min(90vw, 600px) !important; height: auto !important; max-width: none !important;"
        />
        <img
          src="/logos/logo_light_bottom.svg"
          alt="Logo Bottom"
          class="absolute opacity-0"
          data-logo-bottom
          style="transform: translateY(clamp(150px, 25vh, 280px)); width: min(90vw, 600px) !important; height: auto !important; max-width: none !important;"
        />
      </div>
      <div class="font-mono text-white max-w-2xl mx-auto opacity-0" style="min-width: 500px;" data-hero-buttons>
        <div
          class="border border-white/20 bg-black/40 rounded-lg p-4"
          data-terminal-bg
          style="backdrop-filter: blur(0px);"
        >
          <div class="w-full">
            <div class="mb-4 text-lg flex items-center">
              <span class="text-mrover-accent w-6">$</span>
              <span class="text-white" data-typing-text></span>
            </div>
            <div class="flex flex-col gap-2 w-full">
              <a
                href="/about"
                class="no-underline flex items-center gap-3 py-1 transition-all hover:bg-white/10 rounded opacity-0"
                data-option
              >
                <span class="text-mrover-accent w-6">></span>
                <span class="text-white font-semibold">learn_more</span>
              </a>
              <a
                href="/join"
                class="no-underline flex items-center gap-3 py-1 transition-all hover:bg-white/10 rounded opacity-0"
                data-option
              >
                <span class="text-mrover-accent w-6">></span>
                <span class="text-white font-semibold">join</span>
              </a>
              <a
                href="/donate"
                class="no-underline flex items-center gap-3 py-1 transition-all hover:bg-white/10 rounded opacity-0"
                data-option
              >
                <span class="text-mrover-accent w-6">></span>
                <span class="text-white font-semibold">support</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="bg-gradient-to-b from-michigan-blue via-michigan-blue to-michigan-blue">
    <!-- Who we are -->
    <section class="py-24 md:py-32">
      <div class="max-w-6xl mx-auto px-6 lg:px-12">
        <div class="grid md:grid-cols-2 gap-12 lg:gap-16 items-center">
          <div class="space-y-6" data-fade-in>
            <h2 class="text-3xl md:text-4xl font-bold text-white leading-tight">Who we are</h2>
            <p class="text-white/70 text-lg leading-relaxed">
              <span class="text-mrover-accent font-semibold">Student-run, multidisciplinary team</span> building rovers for Mars exploration. We unite students across all years and majors, from Engineering to LSA, to inspire passion for space and develop engineering excellence.
            </p>
          </div>
          <div
            class="relative rounded-xl overflow-hidden shadow-2xl"
            data-fade-in
            data-delay="0.2"
          >
            <img src="/images/SAR_GOBLUESHOT.png" alt="Mars Rover Team" class="w-full h-auto" />
          </div>
        </div>
      </div>
    </section>

    <!-- What we do -->
    <section class="py-24 md:py-32 bg-white/5">
      <div class="max-w-6xl mx-auto px-6 lg:px-12">
        <div class="grid md:grid-cols-2 gap-12 lg:gap-16 items-center">
          <div class="order-2 md:order-1" data-fade-in data-delay="0.2">
            <div class="relative aspect-video rounded-xl overflow-hidden shadow-2xl">
              <iframe
                class="w-full h-full"
                src="https://www.youtube.com/embed/QMt2GuHuyyI?si=Z9nYiCQTfpR1cdBd"
                title="MRover Video"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
            </div>
          </div>
          <div class="space-y-6 order-1 md:order-2" data-fade-in>
            <h2 class="text-3xl md:text-4xl font-bold text-white leading-tight">What we do</h2>
            <p class="text-white/70 text-lg leading-relaxed">
              We're a competition-oriented team aiming to win the <span class="text-mrover-accent font-semibold">University Rover Challenge (URC)</span> at Mars Desert Research Station, Utah. With 36 teams from 15 countries competing, we secured <span class="text-mrover-accent font-semibold">11th place</span> with KIWI!
            </p>
            <div class="pt-2">
              <a href="/rovers" class="inline-block">
                <button
                  class="px-6 py-3 text-sm font-semibold uppercase bg-mrover-accent text-black rounded hover:bg-mrover-accent/90 transition-all cursor-pointer"
                >
                  Explore Our Rovers
                </button>
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Where we are -->
    <section class="py-24 md:py-32">
      <div class="max-w-6xl mx-auto px-6 lg:px-12">
        <div class="grid md:grid-cols-2 gap-12 lg:gap-16 items-center">
          <div class="space-y-6" data-fade-in>
            <h2 class="text-3xl md:text-4xl font-bold text-white leading-tight">Where we are</h2>
            <p class="text-white/70 text-lg leading-relaxed">
              Find us at the <span class="text-white font-medium">Wilson Center</span> on North Campus throughout the week.
            </p>
            <p class="text-white/70 text-lg leading-relaxed">
              Weekly team meetings: <span class="text-mrover-accent font-semibold">Sundays at 12pm</span> in <span class="text-white font-medium">1109 FXB</span>. Stop by anytime!
            </p>
            <a
              href="https://www.google.com/maps/place/Wilson+Student+Team+Project+Center/@42.2932393,-83.7113722,19.82z"
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-2 text-mrover-accent hover:text-mrover-accent/80 transition-colors"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>
              <span class="font-medium">Wilson Student Team Project Center</span>
            </a>
          </div>
          <div
            class="relative rounded-xl overflow-hidden shadow-2xl"
            data-fade-in
            data-delay="0.2"
          >
            <img src="/images/pit.jpg" alt="Team workspace" class="w-full h-auto" />
          </div>
        </div>
      </div>
    </section>

    <!-- Get Involved -->
    <section class="py-24 md:py-32 bg-white/5">
      <div class="max-w-4xl mx-auto px-6 lg:px-12">
        <div class="text-center mb-12" data-fade-in>
          <h2 class="text-3xl md:text-4xl font-bold text-white leading-tight">Get Involved</h2>
        </div>
        <div class="grid md:grid-cols-2 gap-6" data-fade-in data-delay="0.1">
          <!-- Join Us -->
          <a href="/join" class="group block p-8 bg-white/5 border border-white/10 rounded-xl hover:border-mrover-accent/50 hover:bg-white/10 transition-all">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 bg-mrover-accent rounded-lg flex items-center justify-center flex-shrink-0">
                <svg class="w-6 h-6 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
              </div>
              <div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-mrover-accent transition-colors">Join us</h3>
                <p class="text-white/60 leading-relaxed">
                  Passionate about space exploration and engineering? We want you on the team.
                </p>
              </div>
            </div>
          </a>

          <!-- Sponsor Us -->
          <a href="/donate" class="group block p-8 bg-white/5 border border-white/10 rounded-xl hover:border-mrover-accent/50 hover:bg-white/10 transition-all">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 bg-mrover-accent rounded-lg flex items-center justify-center flex-shrink-0">
                <svg class="w-6 h-6 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <div>
                <h3 class="text-xl font-bold text-white mb-2 group-hover:text-mrover-accent transition-colors">Sponsor us</h3>
                <p class="text-white/60 leading-relaxed">
                  Help us win URC. Every contribution, big or small, makes a difference.
                </p>
              </div>
            </div>
          </a>
        </div>
      </div>
    </section>
  </div>
</BaseLayout>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import Lenis from "lenis";

  gsap.registerPlugin(ScrollTrigger);

  const lenis = new Lenis({
    duration: 0.8,
    easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
  });

  function raf(time: number) {
    lenis.raf(time);
    requestAnimationFrame(raf);
  }

  requestAnimationFrame(raf);

  lenis.on("scroll", ScrollTrigger.update);

  gsap.ticker.add((time) => {
    lenis.raf(time * 1000);
  });

  gsap.ticker.lagSmoothing(0);

  window.scrollTo(0, 0);
  lenis.scrollTo(0, { immediate: true });

  // hero intro
  const introTimeline = gsap.timeline({ defaults: { ease: "power2.out" } });

  introTimeline
    .from("[data-hero-overlay]", {
      opacity: 0,
      duration: 0.6,
    })
    .to("[data-block-m]", {
      duration: 0.5,
    })
    .to("[data-block-m]", {
      y: -150,
      opacity: 0,
      duration: 0.5,
      ease: "power2.in",
    })
    .to({}, { duration: 0.3 })
    .to("[data-logo-top]", {
      y: 0,
      opacity: 1,
      duration: 0.5,
      ease: "power2.out",
    })
    .to("[data-logo-bottom]", {
      y: 0,
      opacity: 1,
      duration: 0.8,
      ease: "power2.out",
    })
    .to("[data-hero-buttons]", {
      opacity: 1,
      duration: 0.3,
    })
    .call(() => {
      gsap.to("[data-terminal-bg]", {
        backdropFilter: "blur(4px)",
        duration: 0.6,
        ease: "power2.out",
      });

      import("typed.js").then(({ default: Typed }) => {
        new Typed("[data-typing-text]", {
          strings: ["./mrover"],
          typeSpeed: 80,
          showCursor: true,
          cursorChar: "_",
          onComplete: () => {
            setTimeout(() => {
              const cursor = document.querySelector(".typed-cursor") as HTMLElement;
              if (cursor) {
                cursor.style.display = "none";
              }

              gsap.to("[data-option]", {
                opacity: 1,
                x: 0,
                duration: 0.3,
                stagger: 0.15,
                ease: "power2.out",
              });
            }, 300);
          },
        });
      });
    });

  // scroll animations
  const fadeInElements = document.querySelectorAll("[data-fade-in]");

  fadeInElements.forEach((element) => {
    const delay = parseFloat(element.getAttribute("data-delay") || "0");

    gsap.from(element, {
      scrollTrigger: {
        trigger: element,
        start: "top 85%",
        end: "bottom 20%",
        toggleActions: "play none none reverse",
      },
      y: 30,
      opacity: 0,
      duration: 0.6,
      delay: delay,
      ease: "power2.out",
    });
  });
</script>
