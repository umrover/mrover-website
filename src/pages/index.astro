---
import BaseLayout from "@/layouts/BaseLayout.astro";
---

<BaseLayout title="MRover">
  <head>
    <meta property="og:site_name" content="Michigan Mars Rover Team" />
    <meta property="og:title" content="Home Page" />
    <meta property="og:description" content="Sends user to the main pag for the Michigan Mars Rover Team" />
    <meta property="og:image" content="rover/roverImages/2020/2020.jpg" />
    <meta property="og:url" content="https://mrover.org/" />
    <meta property="og:type" content="website" />
  </head>

  <!-- Hero Section -->
  <div
    class="relative min-h-screen bg-cover bg-center flex items-center justify-center"
    style="background-image: url('/images/rosie_circ.jpg');"
    data-hero
  >
    <div
      class="absolute inset-0 bg-linear-to-br from-michigan-blue/90 via-mrover-base/80 to-black/60"
      data-hero-overlay
    >
    </div>
    <div class="relative z-10 text-center px-6 max-w-5xl py-20">
      <!-- intro anim -->
      <div
        class="relative mb-0 flex items-center justify-center w-full"
        style="height: clamp(250px, 30vh, 400px);"
        data-intro-container
      >
        <img src="/logos/block_M.png" alt="Block M" class="absolute w-50 h-50 object-contain" data-block-m />
        <img
          src="/logos/logo_light_top.svg"
          alt="Logo Top"
          class="absolute opacity-0"
          data-logo-top
          style="transform: translateY(clamp(60px, 12vh, 120px)); width: min(90vw, 600px) !important; height: auto !important; max-width: none !important;"
        />
        <img
          src="/logos/logo_light_bottom.svg"
          alt="Logo Bottom"
          class="absolute opacity-0"
          data-logo-bottom
          style="transform: translateY(clamp(150px, 25vh, 280px)); width: min(90vw, 600px) !important; height: auto !important; max-width: none !important;"
        />
      </div>
      <div class="font-mono text-white max-w-2xl mx-auto opacity-0" style="min-width: 500px;" data-hero-buttons>
        <div
          class="border-2 border-white/20 bg-black/5 rounded-lg p-4"
          data-terminal-bg
          style="backdrop-filter: blur(0px);"
        >
          <div class="w-full">
            <div class="mb-4 text-lg flex items-center">
              <span class="text-green-400 w-6">$</span>
              <span class="text-white" data-typing-text></span>
            </div>
            <div class="flex flex-col gap-2 w-full">
              <a
                href="/about"
                class="no-underline flex items-center gap-3 py-1 transition-all hover:bg-white/10 rounded opacity-0"
                data-option
              >
                <span class="text-green-400 w-6">></span>
                <span class="text-mrover-accent font-semibold">learn_more</span>
              </a>
              <a
                href="/join"
                class="no-underline flex items-center gap-3 py-1 transition-all hover:bg-white/10 rounded opacity-0"
                data-option
              >
                <span class="text-green-400 w-6">></span>
                <span class="text-mrover-accent font-semibold">join</span>
              </a>
              <a
                href="/donate"
                class="no-underline flex items-center gap-3 py-1 transition-all hover:bg-white/10 rounded opacity-0"
                data-option
              >
                <span class="text-green-400 w-6">></span>
                <span class="text-mrover-accent font-semibold">support</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Who we are -->
  <section
    class="relative min-h-screen flex items-center bg-gradient-to-br from-slate-900 via-michigan-blue to-slate-900"
    data-section
  >
    <div
      class="absolute inset-0 opacity-5"
      style="background-image: url('/images/SAR_GOBLUESHOT.png'); background-size: cover; background-position: center;"
    >
    </div>
    <div class="max-w-7xl mx-auto px-6 lg:px-12 relative z-10">
      <div class="grid md:grid-cols-3 gap-8 items-center">
        <div class="space-y-6 md:col-span-1" data-fade-in>
          <h2 class="text-4xl md:text-5xl font-bold text-mrover-accent leading-tight">Who we are</h2>
          <p class="text-gray-200 text-lg leading-relaxed">
            <span class="text-mrover-accent font-semibold">Student-run, multidisciplinary team</span> building rovers for <span class="font-semibold">Mars exploration</span>. We unite students across all years and majors, from Engineering to LSA, to inspire passion for space and develop <span class="font-semibold">engineering excellence</span>.
          </p>
        </div>
        <div
          class="relative h-96 md:h-[500px] rounded-2xl overflow-hidden shadow-2xl border-2 border-mrover-accent/30 transform hover:scale-105 transition-transform duration-300 md:col-span-2"
          data-fade-in
          data-delay="0.2"
        >
          <img src="/images/SAR_GOBLUESHOT.png" alt="Mars Rover Team" class="w-full h-full object-cover" />
        </div>
      </div>
    </div>
  </section>
  <!-- What we do -->
  <section
    class="relative min-h-screen flex items-center bg-gradient-to-br from-michigan-blue via-slate-900 to-michigan-blue"
    data-section
  >
    <div class="max-w-7xl mx-auto px-6 lg:px-12 relative z-10">
      <div class="grid md:grid-cols-3 gap-8 items-center">
        <div class="order-2 md:order-1 md:col-span-2" data-fade-in data-delay="0.2">
          <div class="relative h-96 md:h-[500px] rounded-2xl overflow-hidden shadow-2xl border-2 border-mrover-base/30">
            <iframe
              class="w-full h-full"
              src="https://www.youtube.com/embed/QMt2GuHuyyI?si=Z9nYiCQTfpR1cdBd"
              title="MRover Video"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen></iframe>
          </div>
        </div>
        <div class="space-y-6 order-1 md:order-2 md:col-span-1" data-fade-in>
          <h2 class="text-4xl md:text-5xl font-bold text-mrover-accent leading-tight">What we do</h2>
          <p class="text-gray-200 text-lg leading-relaxed">
            We're a Competition-oriented team aiming to win the <span class="text-mrover-accent font-semibold">University Rover Challenge (URC)</span> at Mars Desert Research Station, Utah. With <span class="font-semibold text-mrover-accent">36 teams from 15 countries</span> competing, we secured <span class="text-mrover-accent font-semibold">11th place</span> with <span class="text-green-400 font-semibold">KIWI</span>!
          </p>
          <div class="pt-4">
            <a href="/rovers" class="inline-block transform hover:scale-105 transition-transform">
              <button
                class="px-8 py-3 text-base font-semibold uppercase bg-mrover-accent text-black rounded-lg hover:bg-mrover-accent/90 shadow-xl hover:shadow-2xl transition-all border-2 border-mrover-accent/50 cursor-pointer mt-2"
              >
                Explore Our Rovers
              </button>
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- Where we are -->
  <section
    class="relative min-h-screen flex items-center bg-gradient-to-br from-slate-900 via-michigan-blue to-slate-900"
    data-section
  >
    <div
      class="absolute inset-0 opacity-5"
      style="background-image: url('/images/pit.jpg'); background-size: cover; background-position: center;"
    >
    </div>
    <div class="max-w-7xl mx-auto px-6 lg:px-12 relative z-10">
      <div class="grid md:grid-cols-3 gap-8 items-center">
        <div class="space-y-6 md:col-span-1" data-fade-in>
          <h2 class="text-4xl md:text-5xl font-bold text-mrover-accent leading-tight">Where we are</h2>
          <p class="text-gray-200 text-lg leading-relaxed">
            Find us at the <span class="font-semibold">Wilson Center</span> on North Campus throughout the week.
          </p>
          <p class="text-gray-200 text-lg leading-relaxed">
            Weekly team meetings: <span class="text-mrover-accent font-semibold">Sundays at 12pm</span> in <span class="font-semibold">1109 FXB</span>. Stop by anytime!
          </p>
          <a
            href="https://www.google.com/maps/place/Wilson+Student+Team+Project+Center/@42.2932393,-83.7113722,19.82z/data=!3m1!5s0x883cae84e4367899:0xcc9c5432d0d48c08!4m6!3m5!1s0x883cae84db8de685:0x42e91c4ceb8a1ac4!8m2!3d42.2933242!4d-83.7108264!16s%2Fg%2F12lslfqjm?entry=ttu&amp;g_ep=EgoyMDI1MTExMS4wIKXMDSoASAFQAw%3D%3D"
            target="_blank"
            rel="noopener noreferrer"
            class="flex items-center gap-3 text-mrover-accent hover:text-mrover-accent/80 transition-colors"
          >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
              ></path>
            </svg>
            <span class="font-semibold">Wilson Student Team Project Center</span>
          </a>
        </div>
        <div
          class="relative h-96 md:h-[500px] rounded-2xl overflow-hidden shadow-2xl border-2 border-mrover-accent/30 transform hover:scale-105 transition-transform duration-300 md:col-span-2"
          data-fade-in
          data-delay="0.2"
        >
          <img src="/images/pit.jpg" alt="Team workspace" class="w-full h-full object-cover" />
        </div>
      </div>
    </div>
  </section><!-- Join/Donate CTA Section -->
  <section
    class="relative min-h-screen flex items-center bg-gradient-to-br from-michigan-blue via-slate-900 to-michigan-blue"
    data-section
  >
    <div class="max-w-7xl mx-auto px-6 lg:px-12 relative z-10">
      <div class="text-center mb-16" data-fade-in>
        <h2 class="text-4xl md:text-5xl font-bold text-mrover-accent mb-6 leading-tight">Get Involved</h2>
      </div>
      <div class="grid md:grid-cols-2 gap-8 lg:gap-12" data-cta-cards>
        <!-- Join Us -->
        <div
          class="group relative text-center space-y-6 p-10 bg-slate-800/50 backdrop-blur-sm rounded-2xl border-2 border-mrover-accent/30 hover:border-mrover-accent transition-all duration-300 shadow-lg hover:shadow-2xl transform hover:-translate-y-2"
          data-cta-card
        >
          <div
            class="w-20 h-20 mx-auto mb-6 bg-mrover-accent rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-110 transition-transform"
          >
            <svg class="w-10 h-10 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
              ></path>
            </svg>
          </div>
          <h3 class="text-3xl font-bold text-white">Join us!</h3>
          <p class="text-gray-200 text-lg leading-relaxed">
            Passionate about <span class="text-mrover-accent font-semibold">space exploration</span> and <span class="font-semibold text-mrover-accent">engineering</span>? We want you on the team.
          </p>
          <a href="/join" class="inline-block transform hover:scale-105 transition-transform">
            <button
              class="px-8 py-3 text-base font-semibold uppercase bg-mrover-accent text-white rounded-lg hover:bg-mrover-accent/90 shadow-xl hover:shadow-2xl transition-all cursor-pointer mt-2"
            >
              How to Join
            </button>
          </a>
        </div>

        <!-- Sponsor Us -->
        <div
          class="group relative text-center space-y-6 p-10 bg-slate-800/50 backdrop-blur-sm rounded-2xl border-2 border-mrover-accent/30 hover:border-mrover-accent transition-all duration-300 shadow-lg hover:shadow-2xl transform hover:-translate-y-2"
          data-cta-card
        >
          <div
            class="w-20 h-20 mx-auto mb-6 bg-mrover-accent rounded-2xl flex items-center justify-center shadow-lg transform group-hover:scale-110 transition-transform"
          >
            <svg class="w-10 h-10 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
              ></path>
            </svg>
          </div>
          <h3 class="text-3xl font-bold text-white">Sponsor us!</h3>
          <p class="text-gray-200 text-lg leading-relaxed">
            Help us <span class="font-semibold text-mrover-accent">win URC</span>. Every contribution, big or small, makes a difference.
          </p>
          <a href="/donate" class="inline-block transform hover:scale-105 transition-transform">
            <button
              class="px-8 py-3 text-base font-semibold uppercase bg-mrover-accent text-white rounded-lg hover:bg-mrover-accent/90 shadow-xl hover:shadow-2xl transition-all cursor-pointer mt-2"
            >
              Sponsor us
            </button>
          </a>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  /* eliminate gaps between sections */
  section {
    display: flex;
    margin: 0;
    padding: 0;
    align-items: center;
    justify-content: center;
  }

  section > div {
    width: 100%;
  }
</style>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import Lenis from "lenis";

  gsap.registerPlugin(ScrollTrigger);

  // lenis init
  const lenis = new Lenis({
    duration: 0.8,
    easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
  });

  function raf(time: number) {
    lenis.raf(time);
    requestAnimationFrame(raf);
  }

  requestAnimationFrame(raf);

  // sync lenis
  lenis.on("scroll", ScrollTrigger.update);

  gsap.ticker.add((time) => {
    lenis.raf(time * 1000);
  });

  gsap.ticker.lagSmoothing(0);

  // ensure top on load
  window.scrollTo(0, 0);
  lenis.scrollTo(0, { immediate: true });

  // snap scroll
  const snapSections = gsap.utils.toArray("[data-section], [data-hero]") as HTMLElement[];
  let snapEnabled = false;

  // enable snap after user scrolls
  let scrollTimeout: number;
  const enableSnap = () => {
    clearTimeout(scrollTimeout);
    scrollTimeout = window.setTimeout(() => {
      snapEnabled = true;
    }, 100);
  };

  lenis.on("scroll", enableSnap);

  ScrollTrigger.create({
    snap: {
      snapTo: (progress) => {
        if (!snapEnabled) return progress;

        // if user is in bottom 20% of page, disable snap (for footer)
        if (progress > 0.85) {
          return progress;
        }

        const totalHeight = document.documentElement.scrollHeight - window.innerHeight;
        const currentScroll = progress * totalHeight;

        // find closest section
        let closest = 0;
        let minDistance = Infinity;

        snapSections.forEach((section) => {
          const sectionTop = section.offsetTop;
          const distance = Math.abs(currentScroll - sectionTop);
          if (distance < minDistance) {
            minDistance = distance;
            closest = sectionTop / totalHeight;
          }
        });

        return closest;
      },
      duration: { min: 0.2, max: 0.6 },
      delay: 0.5,
      ease: "power1.inOut",
    },
  });

  // hero intro
  const introTimeline = gsap.timeline({ defaults: { ease: "power2.out" } });

  introTimeline
    // block m slide in
    .from("[data-hero-overlay]", {
      opacity: 0,
      duration: 0.6,
    })
    // pause after block M
    .to("[data-block-m]", {
      duration: 0.5,
    })
    // slide block M out
    .to("[data-block-m]", {
      y: -150,
      opacity: 0,
      duration: 0.5,
      ease: "power2.in",
    })
    // pause
    .to({}, { duration: 0.3 })
    // logo top slide in
    .to("[data-logo-top]", {
      y: 0,
      opacity: 1,
      duration: 0.5,
      ease: "power2.out",
    })
    // logo bottom slide in
    .to("[data-logo-bottom]", {
      y: 0,
      opacity: 1,
      duration: 0.8,
      ease: "power2.out",
    })
    // terminal prompt
    .to("[data-hero-buttons]", {
      opacity: 1,
      duration: 0.3,
    })
    // typing
    .call(() => {
      // blur terminal bg
      gsap.to("[data-terminal-bg]", {
        backdropFilter: "blur(2px)",
        duration: 0.6,
        ease: "power2.out",
      });

      import("typed.js").then(({ default: Typed }) => {
        const typed = new Typed("[data-typing-text]", {
          strings: ["./mrover"],
          typeSpeed: 80,
          showCursor: true,
          cursorChar: "â–ˆ",
          onComplete: (self) => {
            // hide cursor
            setTimeout(() => {
              const cursor = document.querySelector(".typed-cursor") as HTMLElement;
              if (cursor) {
                cursor.style.display = "none";
              }

              // show options
              gsap.to("[data-option]", {
                opacity: 1,
                x: 0,
                duration: 0.3,
                stagger: 0.15,
                ease: "power2.out",
              });
            }, 300);
          },
        });
      });
    });

  // scroll animations
  const fadeInElements = document.querySelectorAll("[data-fade-in]");

  fadeInElements.forEach((element) => {
    const delay = parseFloat(element.getAttribute("data-delay") || "0");

    gsap.from(element, {
      scrollTrigger: {
        trigger: element,
        start: "top 80%",
        end: "bottom 20%",
        toggleActions: "play none none reverse",
      },
      y: 40,
      opacity: 0,
      duration: 0.5,
      delay: delay,
      ease: "power2.out",
    });
  });
</script>
